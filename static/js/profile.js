// Generated by CoffeeScript 1.8.0
(function() {
  $('.select-image-btn').click(function() {
    return $('#js-image-input').click();
  });

  $('#js-image-input').change(function() {
    var file, formData;
    file = this.files;
    if (file.length > 0) {
      file = file[0];
    }
    formData = new FormData();
    formData.append('picture', file, file.name);
    $("#js-profile").cropper({
      aspectRatio: 1.0
    });
    $('.btn-set-profile').click(function(e) {
      var data;
      e.preventDefault();
      data = $("#js-profile").cropper("getData");
      console.log(data);
      console.log($('#js-profile').attr('src'));
      return $.ajax({
        url: '/accounts/profile/setProfile/',
        type: 'POST',
        data: {
          x: data.x,
          y: data.y,
          width: data.width,
          height: data.height,
          picture: $('#js-profile').attr('src')
        }
      }).then(function(data) {
        $('#myModal').foundation('reveal', 'close');
        return $('.profile-image').attr('src', data.path);
      }).fail(function(err, xhr) {
        return console.log(err);
      });
    });
    return $.ajax({
      url: '/upload/picture/',
      data: formData,
      processData: false,
      contentType: false,
      type: 'POST'
    }).then(function(data) {
      $('#myModal').foundation('reveal', 'open');
      return $("#js-profile").cropper("setImgSrc", data.path);
    }).fail(function(err, xhr) {
      return console.log(err);
    });
  });

  $('.btn-confirm').click(function() {
    var career, introduction;
    career = $('input[name=career]').val();
    introduction = $('textarea[name=introduction]').val();
    return $.ajax({
      url: '/accounts/profile/',
      data: {
        career: career,
        introduction: introduction
      },
      type: 'POST'
    }).then(function() {
      return console.log('succeeded');
    }).fail(function(err, xhr) {
      return console.log(err);
    });
  });

}).call(this);

//# sourceMappingURL=profile.js.map
