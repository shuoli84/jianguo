// Generated by CoffeeScript 1.8.0
(function() {
  var edited, editor, saveArticle;

  editor = new MediumEditor('.editable');

  edited = false;

  $('.editable').on('input', function(e) {
    return edited = true;
  });

  $('.editable').mediumInsert({
    editor: editor,
    addons: {
      images: {
        uploadFile: function($placeholder, file, that) {
          var formData;
          formData = new FormData();
          formData.append('picture', file, file.name);
          return $.ajax({
            url: '/upload/picture/',
            data: formData,
            processData: false,
            contentType: false,
            type: 'POST',
            xhr: function() {
              var xhr;
              xhr = new XMLHttpRequest();
              xhr.upload.onprogress = that.updateProgressBar;
              return xhr;
            }
          }).then(function(data) {
            return that.uploadCompleted({
              responseText: data.path
            }, $placeholder);
          }).fail(function(err, xhr) {
            return that.uploadCompleted({}, $placeholder);
          });
        }
      }
    }
  });

  saveArticle = function() {
    var ob;
    ob = editor.serialize();
    console.log(ob);
    return $.ajax({
      url: '/article/1/edit/',
      type: 'POST',
      data: {
        title: $('input[name=title]').val(),
        content: ob['element-0'].value
      }
    }).then(function(data) {
      return console.log('succeeded');
    }).fail(function(err) {
      return console.log('failed ' + err);
    });
  };

  $('.btn-save').click(function(e) {
    e.preventDefault();
    return saveArticle();
  });

}).call(this);

//# sourceMappingURL=edit_article.js.map
